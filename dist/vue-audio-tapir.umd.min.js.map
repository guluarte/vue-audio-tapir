{"version":3,"file":"vue-audio-tapir.umd.min.js","mappings":"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","sources":["webpack://vue-audio-tapir/webpack/universalModuleDefinition","webpack://vue-audio-tapir/./node_modules/vue-loader/dist/exportHelper.js","webpack://vue-audio-tapir/external umd {\"commonjs\":\"vue\",\"commonjs2\":\"vue\",\"root\":\"Vue\"}","webpack://vue-audio-tapir/webpack/bootstrap","webpack://vue-audio-tapir/webpack/runtime/define property getters","webpack://vue-audio-tapir/webpack/runtime/hasOwnProperty shorthand","webpack://vue-audio-tapir/webpack/runtime/publicPath","webpack://vue-audio-tapir/./node_modules/@vue/cli-service/lib/commands/build/setPublicPath.js","webpack://vue-audio-tapir/./src/components/TapirWidget.vue","webpack://vue-audio-tapir/./src/api/Service.js","webpack://vue-audio-tapir/./node_modules/lib-wav-encoder/index.js","webpack://vue-audio-tapir/./node_modules/convert-time-to-mmss/index.js","webpack://vue-audio-tapir/./node_modules/lib-wav-audio-recorder/index.js","webpack://vue-audio-tapir/./src/components/IconButton.vue","webpack://vue-audio-tapir/./src/components/IconButton.vue?5d45","webpack://vue-audio-tapir/./src/components/TapirWidget.vue?fd73","webpack://vue-audio-tapir/./node_modules/@vue/cli-service/lib/commands/build/entry-lib.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"vue\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"vue-audio-tapir\"] = factory(require(\"vue\"));\n\telse\n\t\troot[\"vue-audio-tapir\"] = factory(root[\"Vue\"]);\n})((typeof self !== 'undefined' ? self : this), function(__WEBPACK_EXTERNAL_MODULE__203__) {\nreturn ","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// runtime helper for setting properties on components\n// in a tree-shakable way\nexports.default = (sfc, props) => {\n    const target = sfc.__vccOpts || sfc;\n    for (const [key, val] of props) {\n        target[key] = val;\n    }\n    return target;\n};\n","module.exports = __WEBPACK_EXTERNAL_MODULE__203__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","__webpack_require__.p = \"\";","/* eslint-disable no-var */\n// This file is imported into lib/wc client bundles.\n\nif (typeof window !== 'undefined') {\n  var currentScript = window.document.currentScript\n  if (process.env.NEED_CURRENTSCRIPT_POLYFILL) {\n    var getCurrentScript = require('@soda/get-current-script')\n    currentScript = getCurrentScript()\n\n    // for backward compatibility, because previously we directly included the polyfill\n    if (!('currentScript' in document)) {\n      Object.defineProperty(document, 'currentScript', { get: getCurrentScript })\n    }\n  }\n\n  var src = currentScript && currentScript.src.match(/(.+\\/)[^/]+\\.js(\\?.*)?$/)\n  if (src) {\n    __webpack_public_path__ = src[1] // eslint-disable-line\n  }\n}\n\n// Indicate to webpack that this file can be concatenated\nexport default null\n","<template>\n  <div class=\"text-center font-sans w-96 mx-auto\">\n    <div>\n      <icon-button\n        :style=\"{ 'border-color': buttonColor }\"\n        :class=\"buttonClass\"\n        v-if=\"recording\"\n        name=\"stop\"\n        @click=\"toggleRecording\"\n      />\n      <icon-button\n        :style=\"{ 'border-color': buttonColor }\"\n        :class=\"buttonClass\"\n        v-else\n        name=\"mic\"\n        @click=\"toggleRecording\"\n      />\n    </div>\n    <div class=\"text-sm text-red-400\">{{ errorMessage }}</div>\n  </div>\n</template>\n\n<script>\nimport Service from \"../api/Service\";\nimport Recorder from \"lib-wav-audio-recorder\"\nimport convertTimeMMSS from \"convert-time-to-mmss\"\nimport \"../styles/app.css\";\nimport IconButton from \"./IconButton.vue\";\n\nconst INSTRUCTION_MESSAGE = \"Click icon to start recording message.\";\nconst INSTRUCTION_MESSAGE_STOP = \"Click icon again to stop recording.\";\nconst ERROR_MESSAGE =\n  \"Failed to use microphone. Please refresh and try again and permit the use of a microphone.\";\nconst SUCCESS_MESSAGE = \"Successfully recorded message!\";\nconst SUCCESS_MESSAGE_SUBMIT = \"Successfully submitted audio message! Thank you!\";\nconst ERROR_SUBMITTING_MESSAGE = \"Error submitting audio message! Please try again later.\";\n\nexport default {\n  name: \"TapirWidget\",\n  props: {\n    // in minutes\n    time: { type: Number, default: 1 },\n    bitRate: { type: Number, default: 128 },\n    sampleRate: { type: Number, default: 44100 },\n    backendEndpoint: { type: String },\n    buttonColor: { type: String, default: \"green\" },\n\n    // callback functions\n    afterRecording: { type: Function },\n    successfulUpload: { type: Function },\n    failedUpload: { type: Function },\n    customUpload: { type: Function, default: null }\n  },\n  components: {\n    IconButton,\n  },\n  data() {\n    return {\n      recording: false,\n      recordedAudio: null,\n      recordedBlob: null,\n      recorder: null,\n      successMessage: null,\n      errorMessage: null,\n      instructionMessage: INSTRUCTION_MESSAGE,\n    };\n  },\n  computed: {\n    buttonClass() {\n      return \"mx-auto h-14 w-14 fill-current text-black cursor-pointer rounded-50 border-2 m-4 p-2\";\n    },\n    recordedTime() {\n      if (this.time && this.recorder?.duration >= this.time * 60) {\n        this.toggleRecording();\n      }\n      return convertTimeMMSS(this.recorder?.duration);\n    },\n  },\n  beforeUnmount() {\n    if (this.recording) {\n      this.stopRecorder();\n    }\n  },\n  methods: {\n    toggleRecording() {\n      this.recording = !this.recording;\n      if (this.recording) {\n        this.initRecorder();\n      } else {\n        this.stopRecording();\n      }\n    },\n    initRecorder() {\n      this.recorder = new Recorder({\n        micFailed: this.micFailed,\n        bitRate: this.bitRate,\n        sampleRate: this.sampleRate,\n      });\n      this.recorder.start();\n      this.successMessage = null;\n      this.errorMessage = null;\n      this.instructionMessage = INSTRUCTION_MESSAGE_STOP;\n      this.service = new Service(this.backendEndpoint);\n    },\n    stopRecording() {\n      this.recorder.stop();\n      const recordList = this.recorder.recordList();\n      this.recordedAudio = recordList[0].url;\n      this.recordedBlob = recordList[0].blob;\n      if (this.recordedAudio) {\n        this.successMessage = SUCCESS_MESSAGE;\n        this.instructionMessage = null;\n      }\n      if (this.afterRecording) {\n        this.sendData();\n      }\n    },\n    async sendData() {\n      if (!this.recordedBlob) {\n        return;\n      }\n\n      let result = null;\n      if (this.customUpload) {\n        result = await this.customUpload(this.recordedBlob);\n      } else {\n        result = await this.service.postBackend(this.recordedBlob);\n      }\n\n      if (result) {\n        this.errorMessage = null;\n        this.successMessage = SUCCESS_MESSAGE_SUBMIT;\n        if (this.successfulUpload) {\n          this.successfulUpload();\n        }\n      } else {\n        // error uploading\n        this.successMessage = null;\n        this.errorMessage = ERROR_SUBMITTING_MESSAGE;\n        if (this.failedUpload) {\n          this.failedUpload();\n        }\n      }\n    },\n    micFailed() {\n      this.recording = false;\n      this.instructionMessage = INSTRUCTION_MESSAGE;\n      this.errorMessage = ERROR_MESSAGE;\n    },\n  },\n};\n</script>\n","export default class Service {\n  constructor(backendEndpoint) {\n    this.backendEndpoint = backendEndpoint;\n  }\n\n  // returns true if successfull, false if failed\n  async postBackend(recordedBlob) {\n    try {\n      const response = await fetch(this.backendEndpoint, {\n        method: \"POST\",\n        body: recordedBlob,\n      });\n      if (!response.ok) {\n        return false;\n      }\n\n      return true;\n    } catch (error) {\n      return false;\n    }\n  }\n}\n","/* eslint-disable */\nexport default class {\n    constructor(options) {\n        this.bufferSize = options.bufferSize || 4096;\n        this.sampleRate = options.sampleRate;\n        this.samples = options.samples;\n    }\n\n    finish() {\n        this._joinSamples();\n\n        const buffer = new ArrayBuffer(44 + this.samples.length * 2);\n        const view = new DataView(buffer);\n\n        this._writeString(view, 0, 'RIFF'); // RIFF identifier\n        view.setUint32(4, 36 + this.samples.length * 2, true); // RIFF chunk length\n        this._writeString(view, 8, 'WAVE'); // RIFF type\n        this._writeString(view, 12, 'fmt '); // format chunk identifier\n        view.setUint32(16, 16, true); // format chunk length\n        view.setUint16(20, 1, true); // sample format (raw)\n        view.setUint16(22, 1, true); // channel count\n        view.setUint32(24, this.sampleRate, true); // sample rate\n        view.setUint32(28, this.sampleRate * 4, true); // byte rate (sample rate * block align)\n        view.setUint16(32, 4, true); // block align (channel count * bytes per sample)\n        view.setUint16(34, 16, true); // bits per sample\n        this._writeString(view, 36, 'data'); // data chunk identifier\n        view.setUint32(40, this.samples.length * 2, true); // data chunk length\n\n        this._floatTo16BitPCM(view, 44, this.samples);\n\n        const blob = new Blob([view], { type: 'audio/wav' });\n\n        return {\n            id: Date.now(),\n            blob,\n            url: URL.createObjectURL(blob),\n        };\n    }\n\n    _floatTo16BitPCM(output, offset, input) {\n        for (let i = 0; i < input.length; i++, offset += 2) {\n            const s = Math.max(-1, Math.min(1, input[i]));\n            output.setInt16(offset, s < 0 ? s * 0x8000 : s * 0x7fff, true);\n        }\n    }\n\n    _joinSamples() {\n        const recordLength = this.samples.length * this.bufferSize;\n        const joinedSamples = new Float64Array(recordLength);\n        let offset = 0;\n\n        for (let i = 0; i < this.samples.length; i++) {\n            const sample = this.samples[i];\n            joinedSamples.set(sample, offset);\n            offset += sample.length;\n        }\n\n        this.samples = joinedSamples;\n    }\n\n    _writeString(view, offset, string) {\n        for (let i = 0; i < string.length; i++) {\n            view.setUint8(offset + i, string.charCodeAt(i));\n        }\n    }\n}\n","export default function convertTimeMMSS(seconds) {\n    if (!seconds) {\n        return null;\n    }\n    return new Date(seconds * 1000).toISOString().substr(14, 5);\n}\n","/* eslint-disable */\nimport WavEncoder from \"lib-wav-encoder\"\nimport convertTimeMMSS from \"convert-time-to-mmss\"\n\n\nexport default class Recorder {\n    constructor(options = {}) {\n        this.beforeRecording = options.beforeRecording;\n        this.pauseRecording = options.pauseRecording;\n        this.afterRecording = options.afterRecording;\n        this.micFailed = options.micFailed;\n\n        this.encoderOptions = {\n            bitRate: options.bitRate,\n            sampleRate: options.sampleRate,\n        };\n\n        this.bufferSize = 4096;\n        this.records = [];\n\n        this.isPause = false;\n        this.isRecording = false;\n\n        this.duration = 0;\n        this.volume = 0;\n\n        this.wavSamples = [];\n\n        this._duration = 0;\n    }\n\n    start() {\n        const constraints = {\n            video: false,\n            audio: {\n                channelCount: 1,\n                echoCancellation: false,\n            },\n        };\n\n        this.beforeRecording && this.beforeRecording(\"start recording\");\n\n        navigator.mediaDevices\n            .getUserMedia(constraints)\n            .then(this._micCaptured.bind(this))\n            .catch(this._micError.bind(this));\n\n        this.isPause = false;\n        this.isRecording = true;\n    }\n\n    stop() {\n        this.stream.getTracks().forEach((track) => track.stop());\n        this.input.disconnect();\n        this.processor.disconnect();\n        this.context.close();\n\n        let record = null;\n\n        const wavEncoder = new WavEncoder({\n            bufferSize: this.bufferSize,\n            sampleRate: this.encoderOptions.sampleRate,\n            samples: this.wavSamples,\n        });\n        record = wavEncoder.finish();\n        this.wavSamples = [];\n\n        record.duration = convertTimeMMSS(this.duration);\n        this.records.push(record);\n\n        this._duration = 0;\n        this.duration = 0;\n\n        this.isPause = false;\n        this.isRecording = false;\n\n        this.afterRecording && this.afterRecording(record);\n    }\n\n    pause() {\n        this.stream.getTracks().forEach((track) => track.stop());\n        this.input.disconnect();\n        this.processor.disconnect();\n\n        this._duration = this.duration;\n        this.isPause = true;\n\n        this.pauseRecording && this.pauseRecording(\"pause recording\");\n    }\n\n    recordList() {\n        return this.records;\n    }\n\n    lastRecord() {\n        return this.records.slice(-1).pop();\n    }\n\n    _micCaptured(stream) {\n        this.context = new (window.AudioContext || window.webkitAudioContext)();\n        this.duration = this._duration;\n        this.input = this.context.createMediaStreamSource(stream);\n        this.processor = this.context.createScriptProcessor(this.bufferSize, 1, 1);\n        this.stream = stream;\n\n        this.processor.onaudioprocess = (ev) => {\n            const sample = ev.inputBuffer.getChannelData(0);\n            let sum = 0.0;\n\n            this.wavSamples.push(new Float32Array(sample));\n\n            for (let i = 0; i < sample.length; ++i) {\n                sum += sample[i] * sample[i];\n            }\n\n            this.duration = parseFloat(this._duration) + parseFloat(this.context.currentTime.toFixed(2));\n            this.volume = Math.sqrt(sum / sample.length).toFixed(2);\n        };\n\n        this.input.connect(this.processor);\n        this.processor.connect(this.context.destination);\n    }\n\n    _micError(error) {\n        this.micFailed && this.micFailed(error);\n    }\n}\n","<template>\n  <div v-html=\"icons[name]\"></div>\n</template>\n\n<script>\nexport default {\n  props: {\n    name: { type: String },\n  },\n  data() {\n    return {\n      icons: {\n        download: '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path d=\"M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zm-6 .67l2.59-2.58L17 11.5l-5 5-5-5 1.41-1.41L11 12.67V3h2z\"/><path fill=\"none\" d=\"M0 0h24v24H0z\"/></svg>',\n        mic: '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path d=\"M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z\"/><path d=\"M0 0h24v24H0z\" fill=\"none\"/></svg>',\n        play: '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path d=\"M8 5v14l11-7z\"/><path d=\"M0 0h24v24H0z\" fill=\"none\"/></svg>',\n        save: '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z\"/></svg>',\n        stop: '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M6 6h12v12H6z\"/></svg>',\n        volume: '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path d=\"M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z\"/><path d=\"M0 0h24v24H0z\" fill=\"none\"/></svg>',\n      },\n    };\n  },\n};\n</script>\n","import { render } from \"./IconButton.vue?vue&type=template&id=3ae5c9e4\"\nimport script from \"./IconButton.vue?vue&type=script&lang=js\"\nexport * from \"./IconButton.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/home/guluarte/sources/vue-audio-tapir/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./TapirWidget.vue?vue&type=template&id=5d67e2a4\"\nimport script from \"./TapirWidget.vue?vue&type=script&lang=js\"\nexport * from \"./TapirWidget.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/home/guluarte/sources/vue-audio-tapir/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import './setPublicPath'\nimport mod from '~entry'\nexport default mod\nexport * from '~entry'\n"],"names":["root","factory","exports","module","require","define","amd","self","this","__WEBPACK_EXTERNAL_MODULE__203__","sfc","props","target","__vccOpts","key","val","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","d","definition","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","p","window","currentScript","document","src","match","class","_createElementBlock","_createElementVNode","$data","_createBlock","_component_icon_button","style","$props","$options","name","onClick","_toDisplayString","Service","constructor","backendEndpoint","recordedBlob","response","fetch","method","body","ok","error","options","bufferSize","sampleRate","samples","finish","_joinSamples","buffer","ArrayBuffer","length","view","DataView","_writeString","setUint32","setUint16","_floatTo16BitPCM","blob","Blob","type","id","Date","now","url","URL","createObjectURL","output","offset","input","i","s","Math","max","min","setInt16","recordLength","joinedSamples","Float64Array","sample","set","string","setUint8","charCodeAt","convertTimeMMSS","seconds","toISOString","substr","Recorder","beforeRecording","pauseRecording","afterRecording","micFailed","encoderOptions","bitRate","records","isPause","isRecording","duration","volume","wavSamples","_duration","start","constraints","video","audio","channelCount","echoCancellation","navigator","mediaDevices","getUserMedia","then","_micCaptured","bind","catch","_micError","stop","stream","getTracks","forEach","track","disconnect","processor","context","close","record","wavEncoder","push","pause","recordList","lastRecord","slice","pop","AudioContext","webkitAudioContext","createMediaStreamSource","createScriptProcessor","onaudioprocess","ev","inputBuffer","getChannelData","sum","Float32Array","parseFloat","currentTime","toFixed","sqrt","connect","destination","innerHTML","String","data","icons","download","mic","play","save","__exports__","INSTRUCTION_MESSAGE","INSTRUCTION_MESSAGE_STOP","ERROR_MESSAGE","SUCCESS_MESSAGE","SUCCESS_MESSAGE_SUBMIT","ERROR_SUBMITTING_MESSAGE","time","Number","default","buttonColor","Function","successfulUpload","failedUpload","customUpload","components","IconButton","recording","recordedAudio","recorder","successMessage","errorMessage","instructionMessage","computed","buttonClass","recordedTime","toggleRecording","beforeUnmount","stopRecorder","methods","initRecorder","stopRecording","service","sendData","async","result","postBackend","render"],"sourceRoot":""}